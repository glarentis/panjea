-- Azzero pagamentoDeterminato e pagamento id in modo da impostarli nuovamente per dolcelit dove per il documento imposto il codice pagamento dell'entita di panjea e non quello proveniente da aton
update ordi_ordini_importati set ordi_ordini_importati.pagamentoDeterminato_id=null,ordi_ordini_importati.pagamento_id=null where (ordi_ordini_importati.provenienza = :provenienza or :tutteProvenienze = 1);
-- Aggiorno i codici di pagamento (setto l'id)
update ordi_ordini_importati inner join part_codici_pagamento on part_codici_pagamento.codicePagamento=ordi_ordini_importati.codicePagamento set ordi_ordini_importati.pagamentoDeterminato_id=part_codici_pagamento.id where (ordi_ordini_importati.provenienza = :provenienza or :tutteProvenienze = 1) and ordi_ordini_importati.pagamentoDeterminato_id is null;
-- Aggiorno i dati di pagamento impostando i dati sull'ordine con i dati sulla sede se non eredita
update ordi_ordini_importati inner join part_sedi_pagamento on part_sedi_pagamento.sedeEntita_id = ordi_ordini_importati.sedeEntita_id set ordi_ordini_importati.pagamento_id = part_sedi_pagamento.codicePagamento_id where ordi_ordini_importati.sedeEredita=false and (ordi_ordini_importati.provenienza = :provenienza or :tutteProvenienze = 1);
-- Aggiorno i dati di pagamento impostando i dati sull'ordine con i dati sulla sede se eredita
update ordi_ordini_importati inner join anag_sedi_entita on anag_sedi_entita.entita_id=ordi_ordini_importati.entita_id inner join anag_tipo_sede_entita ts on ts.id=anag_sedi_entita.tipoSede_id inner join part_sedi_pagamento on part_sedi_pagamento.sedeEntita_id = anag_sedi_entita.id set ordi_ordini_importati.pagamento_id=part_sedi_pagamento.codicePagamento_id where ts.sede_principale=1 and ordi_ordini_importati.sedeEredita=true and (ordi_ordini_importati.provenienza = :provenienza or :tutteProvenienze = 1) ;
